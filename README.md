# Название курса

<Крутая философская фраза>

---

## Лекции

Презентации лекций располагаются в папке `lectures`

- Distributed system definition
- Consistency models
- Distributed system testing [Jepsen & Maelstrom]
- CRDT
- Consensus Intro [Reliable broadcast & FLP & Quorum systems]
- Consensus [Single and multi decree Paxos]
- Consensus [RAFT]
- Transactions

---

## Задачи

- TODO

---

## Проектная работа (Consensus)

TODO

---

## Работа с репозиторием и CI

Пререквизиты - установленные `docker`, `make` и тулинг вашего языка программирования локально.
Несмотря на то, что сборка ваших программ будет производиться в контейнере, разработка - нет (пока).

### Структура репозитория

```
├── Dockerfile
├── github
│   └── workflow
│       └── run-model.yml
├── lecture
├── maelstrom
│   ├── doc
│   │   ├── protocol.md
│   │   ├── results.md
│   │   ├── services.md
│   │   └── workloads.md
│   ├── lib
│   │   └── maelstrom.jar
│   └── maelstrom
├── Makefile
├── README.md
├── task-0
│   └── README.md
├── task-1
│   └── README.md
└── task-2
    └── README.md
```

Вам (студентам) можно только добавлять исходный код в папки задач `task-N`. Редактирование **ЛЮБЫХ** иных существующих файлов **СТРОГО ЗАПРЕЩЕНО**, включая env файлы в папках задач.

### Makefile

Репозиторий управляется через систему сборки `make`.
Переменные:

- `TASK` - название задачи (соответствует имени директории задачи)
- `PROG_LANG` - язык программирования.

  Доступные варианты:
  - `rust`
  - `go`

Доступные target-ы:

- `run` запускает тесты задачи.

Пример:

```sh
make run TASK=task-0 PROG_LANG=rust
```

### Сдача задач CI

Для того, чтобы сдать задачу необходимо сделать пр в ветку `main` из ветки `${PROG_LANG}/${TASK}` с вашими изменениями. Переменные соответствуют таковым в `make` сборке. Пр с веток, имеющих другое название, **РАБОТАТЬ НЕ БУДУТ**.

И помните, любой способ обмануть систему проверки, например редактируя env файлы, карается обнулением задачи безапелляционно.

### Доступные ЯП и шаблоны проектов

Для выполнение задач доступен ограниченные набор ЯП. При этом вы можете использовать **ЛЮБЫЕ** библиотеки. О некоторых из них будет сказано дополнительно.

Доступные ЯП:

- Rust

  Решение задачи разрабатывается в рамках одного crate-а. Вы создаёте его в папке задачи посредством `cargo init .`.
  **ЗАПРЕЩАЕТСЯ** использовать кастомные сборки (наличие файла `build.rs`). В качестве асинхронного рантайма рекомендую использовать [tokio](https://tokio.rs). Для абстрагирования от работы с сырым stdin/stdout maelstrom-а существуюет библиотека [maelstrom-rust-node](https://github.com/sitano/maelstrom-rust-node?tab=readme-ov-file).

- Go

  Решение задачи разрабатывается в рамках одного модуля. Вы создаёте его в папке задачи посредством `go mod init ds-course/task-N`. Для абстрагирования от работы с сырым stdin/stdout maelstrom-а существуют библиотека [maelstrom-go](https://pkg.go.dev/github.com/jepsen-io/maelstrom/demo/go).

О добалении своего ЯП будет сказано в конце.

## Теcтирующая система

## Добавление своего языка программирования

Если вам чем-то не понравились доступные ЯП, вы можете добавить свой!
Для этого вы создаёте отельный пр в `main` ветку репозитория со следующими изменениями:

- Описание default template-а для проекта выше в списке доступных ЯП.
- Установка инструменов языка в контейнер `Dockerfile`
- Добавление языка во **все** условные (`ifeq`) make target-ы в `Makefile`
- Установка инструменов в CI: файл `./github/workflow/run-model.yml`
- Demo-сборка, демонстрирующая, что ваши изменения работают. (Перед мержом она убирается, поэтому советую добавлять её в пр отдельным коммитом). Критерий валидности Demo-сборки - корректная инициализация maelstrom топологии на 3 узла.
